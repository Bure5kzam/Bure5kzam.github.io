---
title: 베이즈 추론
date: 2021-09-23 20:00:00 +/-TTTT
categories: [TIL, math]
tags: [미완성]     # TAG names should always be lowercase
toc : true
comments : true
math : true
mermaid: true
---

# 베이즈 추론(미완성)

로봇이 충돌할 확률을 감지하기 위해 칼만 필터를 공부하면서 정리한 글입니다. 주관과 추상적인 내용이 많으니 참고부탁드립니다.



## 베이즈 정리

칼만 필터는 베이즈 필터를 바탕으로 하기 때문에, 선수학습이 필요했다.

베이즈 필터에서 사용되는 용어들을 정리할 필요가 있었다.

$$ P(H|D) = \frac{P(HnD)}{P(D)} = \frac{P(D|H) * P(H)}{P(D)} $$

베이즈 정리는 P(B|A)를 알고 있을 때 P(A|B)를 구하는데에 쓰인다.

| 기호          | 이름                                                   | 영문      |
| ------------- | ------------------------------------------------------ | --------- |
| P(H)          | 사전확률, 데이터 관찰 전에 가설 H에 대해 믿고있던 정도 | Piror     |
| P(D &#124; H) | 가설 H가 데이터 D를 지지할 가능성                      | liklihood |
| P(H &#124; D) | 데이터로 업데이트된 확률                               | posterior |
| P(D)          | 데이터로 알아낸 증거                                   | Evidence  |

## 베이즈 추론 예시

베이즈 정리를 활용하면 원래 확률에서 데이터의 결과를 반영한 결과를 반영해 확률을 조정할 수 있다.



베이즈 정리에는 아래의 네 가지 개념이 사용된다.

- 사전에 알고 있던 사건의 확률 Prior = P(H)
- 실제 시행을 통해 나타난 확률 Evidence = P(D)
- 시행 결과에 prior가 반영된 정도 likelihood = P(D|H)
- 결과를 통해 변경된 사후확률 = P(H|D)



~~위 내용을 그림으로 나타내면 다음과 같다.~~

### ~~prior~~

~~동전 한개를 던져 앞 뒷면이 나올 확률을 구하는 모델을 만든다고 해보자.~~

동전을 던지면 앞면이 나오거나 뒷면이 나오므로, 

~~H1을 앞면이 나오는 사건~~

~~H2를 뒷면이 나오는 사건 두 가지로 표본 공간을 나타낼 수 있다.~~

~~아직 아무런 실험 데이터가 없기 때문에, 이 사건들이 발생할 확률 P(H1)과 P(H2)는 1/2로 나타낼 수 밖에 없다.~~

~~이렇게 실험 결과가 반영되기 전의 값을 **Prior**라고 한다~~



### ~~likelihood~~

~~실제로 동전을 약 99999번 던졌더니, 66666번의 앞면이 나오고 33333의 뒷면이 나타났다고 하자,~~

~~그럼 전체 H1~~

~~P(D|H) = (2/3 * 1/2 / 1/2 )* 1/2~~



시행을 통해 사후확률에 반영하는 예시를 살펴보자

- 빨강공과 파란공이 들어있는 주머니가 네개가 있다.
  - 1번 주머니에는 빨간공이 3개 들어있다
  - 2번 주머니에는 빨간공이 2개, 파란공이 1개 들어있다
  - 3번 주머니에는 빨간공이 1개, 파란공이 2개 들어있다.
  - 4번 주머니에는 파란공이 3개 들어있다.
- 주머니를 하나 집어 공을 하나 뽑았더니 빨간색이었다.
- 내가 뽑은 공이 들어있던 주머니가 n번 주머니일 확률은?



먼저 사건을 기호로 정리해보자.

주머니 중에 하나를 고르는 사건을 H라고 하고, 내가 뽑은 공이 빨간 색인 사건을 D라고 하자.

주머니가 네 개이고, 공은 주머니 중 하나에서 나왔으므로, 처음 공이 n번 주머니에서 나올 확률인 사전확률은 1/4이다.

$$ P(H_n) = \frac{1}{4} $$

우리가 궁금한 것은 '내가 빨간색 공을 뽑았을 때, 공이 n번 주머니에서 나왔을 확률' 이다. 이는 베이즈 정리로 나타낼 수 있다.



$$ P(H_n|D) = \frac{P(D|H) * P(H)}{P(D)} $$

베이즈 정리에 따르면, 'n번 주머니를 골랐을 때, 주머니에서 빨간 공을 꺼낼 확률'(liklihood)와  '주머니에서 빨간 공을 꺼낼 확률' P(D)만 알면 해당 확률을 구할 수 있다. 



Evidence인 P(D)는 데이터로 산출해낼 수 있다.

여기서는 빨간색 공이 6개이고 전체 공이 12개이므로

$$ P(D) = \frac{1}{2} $$ 이지만 이는 독립시행에서 사용되는 상수이므로 사용하지 않아도 된다.



산출한 내용을 정리하면

| 주머니 | 사전 확률 | 가능도 | 사후 확률 |
| ------ | --------- | ------ | --------- |
| 1      | 1/4       | 1      | 1/4       |
| 2      | 1/4       | 2/3    | 2/18      |
| 3      | 1/4       | 1/3    | 1/36      |
| 4      | 1/4       | 0      | 0         |

이렇게 각각의 사후 확률인 P(H_n|D)를 구할 수 있다.







# 참고 자료

| 이름               | 링크                                                            |
| ------------------ | --------------------------------------------------------------- |
| 베이즈 추론        | (스탠코리아)https://www.youtube.com/watch?v=ELSxxe6gMaQ         |
| 베이즈 정리의 의미 | (공대생의 수학 노트)https://www.youtube.com/watch?v=euH9C61ywEM |