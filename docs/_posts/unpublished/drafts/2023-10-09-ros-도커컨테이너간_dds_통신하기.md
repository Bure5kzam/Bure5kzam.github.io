---
layout: post
title:
date: 2023-10-09 16:48
category:
author:
tags: []
summary:
---

목표는 컨테이너에서 토픽을 송신하여 호스트 머신에서 수신하기

테스트용 노드인 demos_cpp_talker와 demons_cpp_listener를 사용했다.

컨테이너에서 demos_cpp_talker를 실행했는데 호스트머신에서 수신하지 못했다.

1. ROS_DOMAIN_ID가 같은지
2. ROS_LOCALHOST_ONLY가 0인지
3. 같은 DDS를 사용하는지

## DDS 동일하게 맞추기

ros 버전 별로 표준으로 사용하는 dds 종류가 다르다.

내 호스트 머신에는 ubuntu 22.04에 ros-humble가 설치되어있고, 컨테이너에는 ubuntu 20.04에 galactic이 설치되어있다.

ros 버전이 다른 탓일까, 서로 다른 dds를 사용하고 있었다. (`ros2 doctor --report`)

```bash

# 도커 컨테이너의 경우
root@999e38f590c4:/opt/ros/overlay_ws# ros2 doctor --report
   ...

   RMW MIDDLEWARE
middleware name    : rmw_cyclonedds_cpp       # cyclonedds 사용

   ROS 2 INFORMATION
distribution name      : galactic
distribution type      : ros2
distribution status    : end-of-life
release platforms      : {'rhel': ['8'], 'ubuntu': ['focal']}

   TOPIC LIST
topic               : /chatter
publisher count     : 1
subscriber count    : 0



# 호스트 머신의 경우
ros@burePool:~/ros/script$ ros2 doctor --report

   QOS COMPATIBILITY LIST
compatibility status    : No publisher/subscriber pairs found

   RMW MIDDLEWARE
middleware name    : rmw_fastrtps_cpp       # fastrtps 사용

   ROS 2 INFORMATION
distribution name      : humble
distribution type      : ros2
distribution status    : active
release platforms      : {'debian': ['bullseye'], 'rhel': ['8'], 'ubuntu': ['jammy']}

   TOPIC LIST
topic               : none
publisher count     : 0
subscriber count    : 0
   PLATFORM INFORMATION
system           : Linux
platform info    : Linux-5.15.0-83-generic-x86_64-with-glibc2.35
release          : 5.15.0-83-generic
processor        : x86_64

```

[ros humble 문서](https://docs.ros.org/en/galactic/Installation/DDS-Implementations.html)에서 [ros 배포버전별 dds 지원 여부](https://ros.org/reps/rep-2000.html)를 확인할 수 있었다.

galactic과 humble은 둘 다 cyclon dds와 fast dds를 최우선순위로 지원하고 있으니, 골라서 사용하면 될 것 같다.

먼저 fast dds로 통일해보려 햇는데, fast dds 소스에서 받아 실행하려면 cmake 3.22 이상(focal에서 지원하지 않는)이 필요해서 cyclon 으로 통일하기로 했다.






